/*! Copyright (c) ZUIKU.COM - Author: LIJUN - Email: zwlijun@gmail.com */
define(function a(require,exports,module){var a=function(a,b){this.version="B15R0612",this.options=a||{},this.HandleStack=b||null};a.prototype={set:function(a,b){var c="on"+a,d=this.options,e=b||{},f=e.callback||null,g=e.args||[],h=e.context||window,i=e.returnValue;i="boolean"==typeof i?i:!1,c in d&&(this.options[c]=f&&f instanceof Function&&f.apply?{callback:f,args:g,context:h,returnValue:i}:null),e=null,d=null},remove:function(a){this.options["on"+a]=null},get:function(a){var b="on"+a,c=this.options;return b in c?c[b]:(c=null,null)},clear:function(){for(var a in this.options)this.options.hasOwnProperty(a)&&(this.options[a]=null)},exec:function(a,b){var c=this.get(a),d=b||[],e=[].concat(d),f=void 0,g=this.HandleStack;return c&&c.callback&&c.callback.apply&&(e=e.concat(c.args||[]),!0===c.returnValue?f=c.callback.apply(c.context,e):c.callback.apply(c.context,e)),d=null,e=null,g&&a in g.stack&&(f=g.exec(a,b,-1)),f}},a.HandleStack=function(){this.stack={}},a.HandleStack.prototype={add:function(a){var b=this.compare(a),c=a.type;-2===b?(this.stack[c]=[],this.stack[c].push(a)):-1===b&&this.stack[c].push(a)},get:function(a,b){var c=this.stack,d=[],e=0;return a in c&&(d=c[a],e=d.length,b>=0&&e>b&&(d=[d[b]])),d},remove:function(a){var b=this.compare(a);b>=0&&this.stack[a.type].splice(b,1)},removeAll:function(a){a?a in this.stack&&(this.stack[a]=void 0,delete this.stack[a]):(this.stack=void 0,this.stack={})},exec:function(a,b,c){for(var d=this.get(a,c),e=d.length,f=b||[],g=[].concat(f),h=null,i=null,j=void 0,k=0;e>k;k++)if(h=d[k],i=h.data,i&&i.callback&&i.callback.apply){var l=g.concat(i.args||[]),m=i.context;!0===i.returnValue?!1===j?i.callback.apply(m,l):j=i.callback.apply(m,l):i.callback.apply(m,l)}return j},compare:function(a){var b=this.get(a.type),c=b.length,d=null,e=a.data;if(0===c)return-2;for(var f=function(a){for(var b=a.toString(),c=b.split(/\n/),d=c.length,e=[],f=/^([\s ]+)|([\s ]+)$/,g=0;d>g;g++)e.push(c[g].replace(f,""));return f=null,c=null,e.join("")},g=0;c>g;g++)if(d=b[g].data,f(d.callback)==f(e.callback)&&d.context===e.context&&d.args.toString()==e.args.toString()&&d.returnValue==e.returnValue)return g;return-1}},module.exports=a});